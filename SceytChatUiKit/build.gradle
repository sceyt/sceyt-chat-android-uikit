plugins {
    id 'com.android.library'
    id 'org.jetbrains.kotlin.android'
    id 'kotlin-kapt'
    id 'kotlin-parcelize'
}

apply plugin: 'maven-publish'


def getVersionName = { ->
    return "1.6.18"
}

def getArtifactId = { ->
    return "sceytkit"
}

tasks.register('sourceJar', Jar) {
    from android.sourceSets.main.java.srcDirs
    classifier "sources"
}

publishing {
    publications {
        bar(MavenPublication) {
            groupId 'com.sceytkit'
            artifactId getArtifactId()
            version getVersionName()

            artifact sourceJar
            artifact("$buildDir/outputs/aar/SceytChatUiKit-release.aar")

            pom.withXml {
                def dependenciesNode = asNode().appendNode('dependencies')
                configurations.api.allDependencies.each {
                    def dependencyNode = dependenciesNode.appendNode('dependency')
                    dependencyNode.appendNode('groupId', it.group)
                    dependencyNode.appendNode('artifactId', it.name)
                    dependencyNode.appendNode('version', it.version)
                }
            }
        }
    }
}

android {
    compileSdk compile_sdk_version
    namespace 'com.sceyt.sceytchatuikit'

    defaultConfig {
        minSdk min_sdk_version
        targetSdk target_sdk_version

        javaCompileOptions {
            annotationProcessorOptions {
                arguments += ["room.schemaLocation": "$projectDir/schemas".toString()]
            }
        }
        vectorDrawables.useSupportLibrary = true
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8

    }
    kotlinOptions {
        jvmTarget = '1.8'
    }

    buildFeatures {
        dataBinding true
        viewBinding true
    }
}


dependencies {
    api supportDependencies.appCompat
    api supportDependencies.material
    api supportDependencies.constraintlayout
    api supportDependencies.recyclerView
    api supportDependencies.fragmentKtx
    api supportDependencies.coreKtx
    api supportDependencies.sceytSdk
    api supportDependencies.lifecycleRuntime
    api supportDependencies.liveDataKtx
    api supportDependencies.liveEvent
    api supportDependencies.glide
    api supportDependencies.glideTransformations
    api supportDependencies.ion
    api supportDependencies.firebaseBom
    api supportDependencies.firebaseMessaging
    annotationProcessor supportDependencies.roomCompiler
    kapt supportDependencies.roomCompiler
    api supportDependencies.roomRuntime
    api supportDependencies.roomKtx
    api supportDependencies.koinAndroid
    api supportDependencies.exoPlayerMedia
    api supportDependencies.exoPlayerUi
    api supportDependencies.lottie
    api supportDependencies.asyncLayoutInflater
    api supportDependencies.moshiConverter
    api supportDependencies.jsoup
    api supportDependencies.flexbox
    api supportDependencies.sdp
    api supportDependencies.ssp
    api supportDependencies.lightCompressor
    api supportDependencies.workRuntimeKtx
    api supportDependencies.waveSeekBar
    api supportDependencies.photoView
    api supportDependencies.emojiBundled
    api supportDependencies.vanniktechGoogleEmoji
    api supportDependencies.googleCodeLibPhone
}
apply from: "${rootProject.projectDir}/maven-publish/publish-module.gradle"